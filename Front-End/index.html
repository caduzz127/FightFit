<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitFighter — Página Principal</title>
    <link rel="stylesheet" href="assets/css/login.css">
</head>


<body>
    <div class="login-container">
        <div class="login-header">
            <h1>Fit<span>Fighter</span></h1>
            <p>Seu Marcador Fitness</p>
        </div>
        <form id="loginForm">
            <div>
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" placeholder="seu@email.com" required>
            </div>
            <div>
                <label for="senha">Senha:</label>
                <input type="password" id="senha" name="senha" placeholder="Digite sua senha" required>
            </div>
            <input type="submit" value="Entrar">
        </form>
        <div class="login-footer">
            <p>Não tem conta? <a href="telaCadastro.html">Crie uma aqui</a></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const loginForm = document.getElementById('loginForm');
            if (!loginForm) return;

            loginForm.addEventListener('submit', async function (e) {
                e.preventDefault();

                const email = document.getElementById('email').value;
                const senha = document.getElementById('senha').value;

                try {
                    const res = await fetch('http://localhost:8080/fightFit/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ email, senha })
                    });

                    if (!res.ok) {
                        alert('Usuário ou senha inválidos');
                        return;
                    }

                    const usuario = await res.json();

                    // garante que o email será salvo
                    const emailParaSalvar = usuario.email ?? email;

                    sessionStorage.setItem('usuario', JSON.stringify(usuario));
                    sessionStorage.setItem('usuarioEmail', emailParaSalvar);
                    sessionStorage.setItem('usuarioLogado', 'true');

                    window.location.href = 'telaPrincipal.html';

                } catch (err) {
                    alert('Erro de conexão: ' + err.message);
                }
            });
        });
        console.log('Login page script loaded' + emailParaSalvar);
    </script>


</body>

</html>